## API -- Set these page variables
##$searchtype  ##jointable
##$fieldexternalid ##productid
##$fieldexternalvalue ##4322
##$listid ##states
##$listexternalid
##$edit ## are we editing
##$imagetype 
##$catalogid
#if(!$listid)
	#set($listid = $detail.get("listid"))
#end
## get big list of all 
#set( $allsearcher = $searcherManager.getSearcher($catalogid,$listid))	
#set ($types = $allsearcher.allHits)
$context.putPageValue("all", $types)
			
#set( $joinsearcher = $searcherManager.getSearcher($catalogid, $searchtype))
#set ($filteredtracker = $searcherManager.makeFilteredTracker())
$filteredtracker.setSearcher($joinsearcher)
$filteredtracker.setListId($listexternalid)
$filteredtracker.filter($fieldexternalid, $fieldexternalvalue)

$context.putPageValue("checked", $filteredtracker.filteredValues())

#if($edit == false)
	$pages.include("/system/components/xml/multiselect/display.html", $context)
#else
	$pages.include("/system/components/xml/multiselect/edit.html", $context)
#end