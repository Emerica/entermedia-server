#set( $root = "$home$apphome/components/upload/types/dragsync")
#set($catalogid = $context.getRequestParameter("uploadcatalog"))
#set($path = "/${catalogid}/temp/uploading/${user.getUserName()}")

#set( $action = $context.getRequestParameter("action"))
#if( !$action )
#set( $action = "/$applicationid/views/upload/finish.html" )
#end

<form name="uploadwizard" id="uploadwizard"  method="post" target="_top" action="$home$action" >

<div class="subcolumns">
    
    <div id="right-sidebar" style="padding: 0 20px 0 0">
           
        <div id="emdropbox">
            Drag and Drop files here
        </div>
        
        <input type="file" id="fileElem" multiple style="display:none" onchange="handleFiles(this.files)">
        <a class="btn pickfiles" href="#" id="filePicker">Pick Files...</a>
        
        <ul id="up-files-list">
            <li><a href="#"><span>File 1</span></a><a class="delete-row ir" href="#">Delete</a></li>
            <li><a href="#"><span>File 1</span></a><a class="delete-row ir" href="#">Delete</a></li>
            <li><a href="#"><span>File 1</span></a><a class="delete-row ir" href="#">Delete</a></li>
            <li><a href="#"><span>File 1</span></a><a class="delete-row ir" href="#">Delete</a></li>
            <li><a href="#"><span>File 1</span></a><a class="delete-row ir" href="#">Delete</a></li>
        </ul>
        
    </div>
    <div id="main-area" style="vertical-align: top;">
        
            
        <div class="ui-widget uipanel">
            <div  class="ui-widget-header">Upload Media</div>
            <div  class="ui-widget-content no-padding">
             
             $path
             
             <p class="hints" style="text-align: left; padding: 0 20px;" id="drag-and-drop-instructions">
                To upload multiple files, drag and drop from your computer's hard drive to the area on the left.  You can also click on <strong>Pick Files</strong> and then select multiple files by using the <strong>Shift</strong> key on your keyboard while clicking on the files you wish to uplaod.
             </p>
             
             
                <input type="hidden" name="catalogid" value="$!catalogid"/>
                <input type="hidden" name="searchtype" value="asset"/>
                
                <div id="enabledwithpick" style="display: none;">
                    <a class="btn" href="#" onclick="document.uploadwizard.submit()">Upload</a>     
                    <table id="emfilelist" class="emresultscontent">
                            <!-- <tr id="tableheader">
                                <th class="firstheader" ></th><th style="min-width: 150px;">File Name</th><th>Size</th><th>Description</th><th  class="lastheader" > Asset Type</th>
                            </tr> -->
                            <tbody>
                            </tbody>
                    </table>    
                </div>
                
                <!-- Fields pointing to files go here -->
                <div id="uploadforminsertionpoint" > </div>
                <input type="hidden" name="hitsname" value="hits" />
            #set( $searcher = $mediaarchive.getAssetSearcher() )
    
#set($details =  $searcher.getDetailsForView("asset/assettype/default/multipleupload", $user))
#foreach($detail in $details)
                <input type="hidden" name="field" value="$detail.id" />
#end                
             
            </div> 
        </div>
        <a class="btn green" id="upload">Upload</a> 
    </div>
    
</div>

</form>



<script>
    
function parseFiles(e) {
    
    
    for (var i = 0, numFiles = files.length; i < numFiles; i++) {
        var file = files[i];
        $('#up-files-list').append('<li><a href="#"><span>' + file.name + '</span></a><a class="delete-row ir" href="#">Delete</a></li>')
    }
} 


 
$(document).ready(function(){
    $('#filePicker').click(function(e){
       $('#fileElem').trigger('click');
       e.preventDefault(); 
       handleFiles();
       parseFiles();
    });
     
    var inputElement = document.getElementById("fileElem");
    inputElement.addEventListener("change", handleFiles, false);
    
    function handleFiles() {
      var fileList = this.files;
    } 
     
 })

</script>


