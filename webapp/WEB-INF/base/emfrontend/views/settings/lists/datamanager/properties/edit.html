
#set( $dataroot = $content.dataroot )
<div class="tab-actions">
	<strong>Editing $!property.name</strong>
	<div style="float:right;">
	<select id="proptomodify" name="proptomodify" onchange="loadPropertyEdit($(this).val());" style="margin-top: 6px;">
		<option value="" ></option>
			#foreach( $detail in $searcher.getPropertyDetails())
				<option value="$detail.id" #if($property.id == $detail.id)selected="selected"#end>$detail.text</option>
			#end
		</select>
	
	</div>
</div>
<div id="editlayout">
#set( $origURL = $context.getRequestParameter("origURL" ) )		
		
<form id="dataeditor" name="dataeditor" method="post" action="$home$dataroot/properties/save.html" >
	<input name="save" type="hidden" value="true" />
	<input name="id" type="hidden" value="$!property.id" />
	<input name="catalogid" type="hidden" value="$searcher.catalogId" />
	<input name="searchtype" type="hidden" value="$searcher.getSearchType()" />
<div id="edit-data">	



<table class="settings-table">

	<tr> <td>ID:</td> <td><input type="text" name="newid" value="$property.id" /></td> </tr>
	<tr> <td>[[Label]]:</td> <td><input type="text" name="name" value="$!property.name" /></td> </tr>

	
	<tr> <td>[[Editable]]:</td> <td><input name="editable" type="checkbox" #if ($property.editable == true) checked #end value="true"/> </td> </tr>
	<input type="hidden" name="field" value="required"/>
	<tr> <td>[[Required]]:</td> <td><input name="required.value" type="checkbox" #if ($property.required == true) checked #end value="true"/> </td> </tr>
	<tr> <td>[[Index]]:</td> <td><input name="index" type="checkbox" #if ($property.index == true) checked #end value="true"/> </td> </tr>
	<tr> <td>[[Stored]]:</td> <td><input name="stored" type="checkbox" #if ($property.stored == true) checked #end value="true"/> </td> </tr>

	<tr> <td>[[Data Type]]:</td>
	<td>
	<select name="datatype">
		<option value="" >Text</option>
		<option value="boolean" #if ($property.datatype == "boolean") selected #end >[[Boolean]]</option>
		<option value="number" #if ($property.datatype == "number") selected #end >[[Number]]</option>
		<option value="long" #if ($property.datatype == "long") selected #end >Long</option>
		<option value="double" #if ($property.datatype == "double") selected #end >Double</option>
		<option value="date" #if ($property.datatype == "date") selected #end >[[Date]]</option>
		<option value="list" #if ($property.datatype == "list") selected #end >[[List]]</option>
		<option value="file" #if ($property.datatype == "file") selected #end >[[File]]</option>
		<option value="image" #if ($property.datatype == "image") selected #end >[[Image]]</option>
	</select>

	#if($property.isList())
		#if( $pages.doesExist("$apphome/views/settings/lists/$property.id/parent/index.html") )
			<a id="${element.id}editlist"  class="btn right" style="margin-right: 10px;" href="$home$apphome/views/settings/lists/$property.id/parent/index.html">Edit Values</a>
		#else
			<a id="${element.id}editlist"  class="btn right" style="margin-right: 10px;" href="$home$apphome/views/settings/lists/datamanager/list/index.html?catalogid=$property.getListCatalogId()&searchtype=$property.getListId()&iframe=true&width=500&height=400">Edit Values</a>
		#end
	#end
	</td>
		
	</tr>
	<tr> <td>[[Render Type]]:</td>
	<td>
	<select name="viewtype">
		<option value="" >Default</option>
		<option value="boolean" #if ($property.viewtype == "boolean") selected #end >[[Boolean]]</option>
		<option value="number" #if ($property.viewtype == "number") selected #end >[[Number]]</option>
		<option value="long" #if ($property.viewtype == "long") selected #end >Long</option>
		<option value="double" #if ($property.viewtype == "double") selected #end >Double</option>
		<option value="date" #if ($property.viewtype == "date") selected #end >[[Date]]</option>
		<option value="list" #if ($property.viewtype == "list") selected #end >[[List]]</option>
		<option value="permission" #if ($property.viewtype == "permission") selected #end >[[Permission]]</option>
		<option value="file" #if ($property.viewtype == "file") selected #end >[[File]]</option>
		<option value="user" #if ($property.viewtype == "user") selected #end >[[User]]</option>
		<option value="image" #if ($property.viewtype == "image") selected #end >[[Image]]</option>
		<option value="multiselect" #if ($property.viewtype == "multiselect") selected #end >[[Multi-Select]]</option>
		<option value="textjoin" #if ($property.viewtype == "textjoin") selected #end >[[Text Join]]</option>
	</select>	

	</td>
	</tr>

</table>

<table id="advanced" class="settings-table" style="margin-top: -20px; display: none;">

	<tr class="tableheader"> <th colspan="2">Advanced</th> </td>

	<tr> <td>[[External ID]]:</td> <td><input type="text" name="externalid" value="$!property.externalId" /></td> </tr>
	<tr> <td>[[Is Keyword]]:</td> <td><input name="keyword" type="checkbox" #if ($property.keyword == true) checked #end value="true"/> </td> </tr>
	<tr> <td>[[In Filters]]:</td> <td><input name="filter" type="checkbox" #if ($property.filter == true) checked #end value="true"/> </td> </tr>
	<tr> <td>[[Internal Use]]:</td> <td><input name="internalfield" type="checkbox" #if ($property.internalfield == "true") checked #end value="true"/> </td> </tr>	
	<input type="hidden" name="field" value="listid"/>
	<input type="hidden" name="field" value="listcatalogid"/>
	<input type="hidden" name="field" value="sort"/>
	<input type="hidden" name="field" value="query"/>
	<input type="hidden" name="field" value="foreignkeyid"/>

	<tr> <td>[[List ID]]:</td> <td><input type="text" name="listid.value" value="$!property.listid"/> </td> </tr>
	<tr> <td>[[List Catalog ID]]:</td> <td><input type="text" name="listcatalogid.value" value="$!property.listcatalogid"/> </td> </tr>
	<tr> <td>[[List Sort Field]]:</td> <td><input type="text" name="sort.value" value="$!property.sort"/> </td> </tr>
	<tr> <td>[[List Query]]:</td> <td><input type="text" name="query.value" value="$!property.query"/> </td> </tr>
	<tr> <td>[[Foreign Key ID]]:</td> <td><input type="text" name="foreignkeyid.value" value="$!property.foreignkeyid"/> </td> </tr>
</div>
<input class="btn right" style="margin-right: 20px;" type="submit" value="Save" />

</div>
</form>

#if( $savedok && $origURL )
<div class="embutton">
	<a href="$origURL">[[Go Back]]</a>	
</div>	
#end


<a class="btn red" style="margin-left: 20px; margin-right: 5px;" href="remove.html?id=$!property.id&catalogid=$catalogid&searchtype=$searcher.getSearchType()">[[Delete Field]]</a>
<a class="btn" style="margin-top: 3px;" id="viewadvanced">View Advanced Options</a>

</div>


<script>
    $('#viewadvanced').click(function(){
        if ( $(this).hasClass('show') ) {
            $('#advanced').hide();
            $(this).html('View Advanced Options');
            $(this).removeClass('show');
        } else {
            $('#advanced').show();
            $(this).html('Hide Advanced Options');
            $(this).addClass('show');
        }  
    });

	loadPropertyEdit = function(selectedid) {

		jQuery("#propertyEditPanel").load("$home${dataroot}/properties/edit.html?id=" + selectedid + "&oemaxlevel=1&catalogid=${mediaarchive.getCatalogId()}&searchtype=${searcher.getSearchType()}");
	}

</script>