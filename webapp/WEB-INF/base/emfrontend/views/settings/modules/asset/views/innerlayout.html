#set($searcher = $mediaarchive.getAssetSearcher())
#set($viewid = $context.getRequestParameter("viewid"))
<div class="subcolumns">
          <div class="c33l">
            <div class="subcl">
<div class="ui-widget" style="overflow: hidden;">
<div class="ui-widget-header">Views</div>
<div  class="ui-widget-content emselectmenu">

#set($views = $searcherManager.getList("$catalogid", "assetview"))

<h4>[[Select a View]]</h4>
<select style="margin: 0 0 20px 0;" id="viewid" name="viewid" onchange="loadViews();">
		<option value="" ></option>
			#foreach( $target in $views)
				<option value="$target.id" #if($viewid == $target.id)selected="selected"#end byassettype="$!target.byassettype">$target</option>
			#end			
		</select>

#if( $viewid )

#set($view = $searcherManager.getData("$catalogid", "assetview", $viewid))
#if($view.byassettype == "true" )

<h4>[[Select an Asset Type]]</h4>
#set($current = $context.getRequestParameter("assettype")) 
#set($assettypesearcher = $searcherManager.getSearcher($catalogid, "assettype"))

<select style="margin: 0 0 20px 0;" id="assettype" name="assettype" onchange="loadViews()">
		<option value="default" >Default</option>
			#foreach($item in $assettypesearcher.fieldSearch("id","*","textUp"))
				<option #if($current == $item.id) selected #end value="$item.id">$item</option>
			#end
		</select>
#end
	
#end
</div>
</div>

</div>
          </div>
          <div class="c66r">
            <div class="subcr" >


<div id="metadataeditarea">            
$pages.includeContent()
</div>


<script type="text/javascript">

	loadViews = function() {
		var selected = jQuery("#viewid option:selected");
		
		var selectedid = selected.val();

		var view = "";

		var byassettype = selected.attr("byassettype");
		if( byassettype == 'true')		
		{
			var assettype = jQuery("#assettype option:selected");
			var assettypeid = assettype.val();
			if( assettypeid == 'default' || typeof(assettypeid) == 'undefined')
			{
				view = "asset/assettype/default/" + selectedid;
			}
			else
			{
				view = "asset/assettype/" + assettypeid + "/" + selectedid;
			}
		}
		else
		{
			view = 	selectedid;
		}
		document.location.href = "$home$apphome/views//settings/modules/asset/views/editing.html?viewpath=" + view + "&viewid=" + selectedid + "&assettype=" +  assettypeid +"&catalogid=${mediaarchive.getCatalogId()}&searchtype=${searcher.getSearchType()}";
	}

	removeProperty = function() {
		var selected = jQuery("select option:selected");
		var selectedid = selected.val();
		jQuery("#modifyproperties").load("$home$apphome/views/settings/metadata/fields/removeproperty.html?id=" + selectedid + "&catalogid=${mediaarchive.getCatalogId()}&searchtype=${searcher.getSearchType()}");
	}
	
	createProperty = function() {
		jQuery("#modifyproperties").load("$home$apphome/views/settings/metadata/fields/addproperty.html?catalogid=${mediaarchive.getCatalogId()}&searchtype=${searcher.getSearchType()}");
	}
</script>

</div></div></div>